---
name: "SAML Login with Keycloak"
status: Active
priority: Smoke test
team_ownership: "Suite Users"
---

## MM-T3657: SAML Login with Keycloak

---

**Step 1**

SAML Login with Keycloak\
–––––––––––––––––––––––––

1. In the mattermost-server, create a new file named \`config.override.mk\` and add the following line to it:\
   ENABLED\_DOCKER\_SERVICES ?= mysql postgres inbucket elasticsearch keycloak\`

2. Restart the server.

3. Visit https\://localhost:8484 and login with credentials: (mmuser/mostest)

4. Create a new user from Users page.

5. Edit SAML Settings in Mattermost.

   - see https\://github.com/mattermost/mattermost-server/blob/master/build/docker/keycloak/README.md
   - copy SAMLSettings
   - Set IDP Public Certificate (https\://github.com/mattermost/mattermost-server/blob/master/build/docker/keycloak/keycloak\_cert.pem)
   - Turn on Encryption and set public/private certificates
   - Turn on Sign Request

6. On the Keycloak Admin portal

   - Go To clients page
   -  Click on the link for client https\://localhost:8065/login/sso/saml
   -  On the settings tab, turn on the Encrypt Assertions and Client Signature Required and save.
   -  On the SAML Keys tab, choose the option to Import and then select Certificate PEM
   - Import the cert file set in MM Config.

7. Login with created user using SAML and check if user is logged in successfully

**Expected**

- SAML User should be logged in from Keycloak successfully
