{
  "id": 8232511,
  "key": "MM-T3657",
  "name": "SAML Login with Keycloak",
  "createdOn": "2020-12-15T16:04:26Z",
  "objective": null,
  "precondition": null,
  "estimatedTime": null,
  "labels": [],
  "component": { "id": 14314, "name": "System Console" },
  "priority": { "id": 1251319, "name": "Smoke test" },
  "status": { "id": 890281, "name": "Active" },
  "folder": {
    "id": 404332,
    "name": "SAML",
    "parentId": 2954447,
    "fullNames": ["Suite", "SAML"],
    "fullPath": "suite/saml"
  },
  "customFields": {
    "Fix Versions": ["v5.30 (December 2020)"],
    "Playwright": null,
    "Authors": "",
    "Priority P1 to P4": "P2 - Core Functions (Do core functions work?)",
    "Update notes": "",
    "Rainforest": [],
    "Cypress Reports": null,
    "Team Ownership": ["Suite Users"],
    "Manual Test Environments": ["Webapp"],
    "Detox": null,
    "Cypress": "Evaluating",
    "MMCTL": null,
    "Last Updated": "",
    "Selenium": null,
    "Tags": ["Cloud N/A"],
    "Location": "SAML"
  },
  "steps": [
    {
      "inline": {
        "description": "SAML Login with Keycloak<br>–––––––––––––––––––––––––<ol><li>In the mattermost-server, create a new file named `config.override.mk` and add the following line to it:<br>ENABLED_DOCKER_SERVICES ?= mysql postgres inbucket elasticsearch keycloak`</li><li>Restart the server.</li><li>Visit https://localhost:8484 and login with credentials: (mmuser/mostest)</li><li>Create a new user from Users page.</li><li>Edit SAML Settings in Mattermost.<ul><li>see https://github.com/mattermost/mattermost-server/blob/master/build/docker/keycloak/README.md</li><li>copy SAMLSettings</li><li>Set IDP Public Certificate (https://github.com/mattermost/mattermost-server/blob/master/build/docker/keycloak/keycloak_cert.pem)</li><li>Turn on Encryption and set public/private certificates</li><li>Turn on Sign Request</li></ul></li><li>On the Keycloak Admin portal<ul><li>Go To clients page</li><li>&nbsp;Click on the link for client https://localhost:8065/login/sso/saml</li><li>&nbsp;On the settings tab, turn on the Encrypt Assertions and Client Signature Required and save.</li><li>&nbsp;On the SAML Keys tab, choose the option to Import and then select Certificate PEM</li><li>Import the cert file set in MM Config.</li></ul></li><li>Login with created user using SAML and check if user is logged in successfully</li></ol>",
        "testData": "",
        "expectedResult": "<ul><li>SAML User should be logged in from Keycloak successfully</li></ul>",
        "customFields": {
          "Fix Versions": [],
          "Related ticket(s)": "",
          "Important notes about this step": ""
        }
      },
      "testCase": null
    }
  ],
  "caseHashed": "d7ea62255ed883bb69bba3a7c3cdd00304f31c579a1b8f637b0967234b45fc2574b24959da7f93e6f2f3a13e5f735516",
  "stepsHashed": "d40d53da1a35b681e9c57193f2bda1fd569d32c06d0e093f934d447540565c60d21b48ab31276cb11d02308118e086f7"
}
