---
name: "Check for Ignore Guest Users when Synchronizing with AD/LDAP"
status: Active
priority: Smoke test
team_ownership: "Suite Users"
---

## MM-T3420: Check for Ignore Guest Users when Synchronizing with AD/LDAP

---

**Step 1**

**Setup ADFS and LDAP with following configurations:**\
\
**ADFS - **\
1\. ADFS setup in Active Directory (adfs.e2etest.dev.spinmint.com)\
2\. SAML needs to be setup with ADFS. (https\://docs.mattermost.com/deployment/sso-saml-adfs-msws2016.html)\
2a. Set "Enable Synchronizing SAML Accounts with AD/LDAP" = true\
2b. Set "Ignore Guest Users when Synchronizing with AD/LDAP" = true\
2c. Set "Guest Filter" = Username=\*guest\* 2b. Set "Id Attribute" = "objectGUID"\
3\. Mattermost must be running in SSL. (https\://docs.mattermost.com/install/config-tls-mattermost.html)\
\
**LDAP - **\
1\. AD/LDAP setup in Active Directory (adfs.e2etest.dev.spinmint.com)\
2\. LDAP needs to be setup in Mattermost (https\://docs.mattermost.com/deployment/sso-ldap.html)\
2a. Set "Enable Synchronization with AD/LDAP" = true 2b.\
Set "ID Attribute" = "objectGUID"\
2c. Set "User Filter" = "(sn=user)"\
\
\
**Test Steps:**\
1\. Once both systems are setup and working independently, Test SAML Login by logging in as a user containing the username guest in it. For example: samlguest-1 or samlguest-2\
2\. Go to LDAP, run LDAP Sync. - Ensure Guest User was not deactivated.\
\
Repeat the above steps by setting the config "Ignore Guest Users when Synchronizing with AD/LDAP" to false in SAML configuration page and verify that Guest User gets deactivated when LDAP Sync is run

**Expected**

- If the config "Ignore Guest Users when Synchronizing with AD/LDAP" is set to True, then Guest User should not be deactivated when LDAP Sync is complete. 
- If the config "Ignore Guest Users when Synchronizing with AD/LDAP" is set to False, then Guest User should be deactivated when LDAP Sync is complete. 
