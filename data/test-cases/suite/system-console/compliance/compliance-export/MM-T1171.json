{
  "id": 4058901,
  "key": "MM-T1171",
  "name": "Compliance Export - Bot / webhook post indicates bot username in the export in Global Relay",
  "createdOn": "2020-01-22T19:26:29Z",
  "objective": null,
  "precondition": null,
  "estimatedTime": null,
  "labels": ["system-console"],
  "component": null,
  "priority": { "id": 401950, "name": "Normal" },
  "status": { "id": 890281, "name": "Active" },
  "folder": {
    "id": 569413,
    "name": "Compliance Export",
    "parentId": 570062,
    "fullNames": ["Suite", "System Console", "Compliance", "Compliance Export"],
    "fullPath": "suite/system-console/compliance/compliance-export"
  },
  "customFields": {
    "Fix Versions": ["v5.18 (Dec 2019)"],
    "Playwright": null,
    "Authors": "",
    "Priority P1 to P4": "P3 - Deep Functions (Do extensive scenarios work?)",
    "Update notes": "",
    "Rainforest": [],
    "Cypress Reports": null,
    "Team Ownership": ["Suite Users"],
    "Manual Test Environments": ["Webapp", "Cloud"],
    "Detox": null,
    "Cypress": "Ticket Open",
    "MMCTL": null,
    "Last Updated": "",
    "Selenium": null,
    "Tags": ["Never tested"],
    "Location": "System Console"
  },
  "steps": [
    {
      "inline": {
        "description": "Compliance - Compliance Export - Custom Post Types<br />–––––––––––––––––––––––––<ol><li>Create a webhook</li><li>Post a user message</li><li>Simulate a bot and webhook post with these requests:<br /><br />{code}<br />curl -i -X POST -H \"Content-Type: application/json\" -d \"{\\\"text\\\": \\\"This is an incoming webhook message\\\"}\" http://127.0.0.1:8065/hooks/webhookidentifier<br />{code}<br /><br />{code}<br />curl -i -X POST -H \"Content-Type: application/json\" -d \"{\\\"text\\\": \\\"This is a bot message\\\"}\" http://127.0.0.1:8065/hooks/webhookidentifier<br />{code}<br /><br /></li><li>Update the {{Props}} setting for the second post using this query:<br /><br />{code:sql}<br />UPDATE Posts Set Props = '{\"from_webhook\":\"true\",\"html\":\"<strong>Test HTML</strong>\",\"override_username\":\"test_username_override\",\"webhook_display_name\":\"Test Bot\"}', Type = 'custom_bot_type' WHERE Message = 'This is a bot message';<br />{code}<br /><br />Postman:<br />{<br />\"username\": \"test_username_override\",<br />\"type\": \"custom_bot_type\",<br />\"text\": \"This is a bot message\"<br />}<br /><br /></li><li>Run the Global Relay Export</li><li>Verify that the bot message you modified indicates the bot user name</li></ol>",
        "testData": "<img src=\"https://smartbear-tm4j-prod-us-west-2-attachment-rich-text.s3.us-west-2.amazonaws.com/embedded-f3277290f945470c4add5d21ef3dc7ca7b74388fc7152bfb6b99ae58c66a95a8-1605085977550-Screen+Shot+2020-11-11+at+1.12.29+AM.png\" style=\"width:380px\" class=\"fr-fil fr-dib\" /><br /><img src=\"https://smartbear-tm4j-prod-us-west-2-attachment-rich-text.s3.us-west-2.amazonaws.com/embedded-f3277290f945470c4add5d21ef3dc7ca7b74388fc7152bfb6b99ae58c66a95a8-1605086237869-Screen+Shot+2020-11-11+at+1.16.24+AM.png\" style=\"width:300px\" class=\"fr-fil fr-dib\" />",
        "expectedResult": "<ul><li>The bot message \"This is a bot message\" should have the username @test_username_override instead of the webhook user.</li></ul>",
        "customFields": {
          "Fix Versions": ["v5.18 (Dec 2019)"],
          "Related ticket(s)": "(<strong><span style=\"color:rgb(65, 168, 95)\">Story</span></strong>) <a href=\"https://mattermost.atlassian.net/browse/MM-17466\">Add custom post types to compliance exports — MM-17466</a>",
          "Important notes about this step": ""
        }
      },
      "testCase": null
    }
  ],
  "caseHashed": "c367db3c66063137c5428cac41e0ec1149ba36d8f373926f3f29b05b2d3b0811dd1401d9bee72ede8d2806eddca68244",
  "stepsHashed": "a80be3b1257741bf241a741d744e61f11064a329fe9ff2dad61d90e297a1efc02a06f159cf0b4b02cce7aa627cd574e6"
}
