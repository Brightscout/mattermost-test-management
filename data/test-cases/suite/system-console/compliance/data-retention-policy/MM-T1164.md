---
# (Required) Ensure all values are filled up
name: "Data Retention - Entries not removed from Audits Table"
status: Active
priority: Normal
folder: Data Retention Policy
authors: ""
team_ownership: 
- Suite Users

# (Optional) Test type and tools
cypress: N/A
detox: null
mmctl: null
playwright: null
rainforest: 
- N/A
manual_test_environments: 
- Webapp

# (Optional)
component: null
priority_p1_to_p4: null
location: System Console
tags: 
- Never tested
labels: 
- system-console
- fix-versions-not-empty-2022cleanup

# Do not change
id: 4058894
key: MM-T1164
folder_path: suite/system-console/compliance/data-retention-policy
created_on: "2020-01-22T19:26:28Z"
last_updated: ""
case_hashed: c3ccb6fbdc4c102f4c6b9d9a6f9b7741d850d55739aeedc5dc1c55e6d968c32df830f84e3b60a4308405626fb20c6990
steps_hashed: 00eddb39346e6fdfe0cd3e2460cb537c229191ef244252b8afb0099042841d70666f815af65d60ff94f3c24efcf1bb77
---

## MM-T1164: Data Retention - Entries not removed from Audits Table

---

**Step 1**

**\*\* DO NOT RUN THIS TEST UNTIL WE HAVE A BACKUP DATABASE FOR THE TEST SERVER \*\***\
\
Data Retention - Entries not removed from Audits Table\
–––––––––––––––––––––––––

1. Ensure a user has logged in multiple times and there are records present in Account Settings ➜ Security ➜ Access History page (at least more than 30 days old)
2. Login as SysAdmin and navigate to System Console ➜ Data Retention Policy and set "Message Retention" to "Keep messages for a set amount of time" and 30 days
3. Run the Deletion Job Now and once the job is completed successfully, check if the user's login history more than 30 days old should not be deleted in Account Settings ➜ Security ➜ Access History page
4. Also check no records are deleted from the Audits table even when there are records older than 30 days in it.

_Related ticket(s):_

(**Story**) [Data retention is deleting user login logs within the audit table — MM-19877](https://mattermost.atlassian.net/browse/MM-19877)

**Expected**

- Running the Deletion job in Data Retention Policy should not remove any entries related to user's Access history
