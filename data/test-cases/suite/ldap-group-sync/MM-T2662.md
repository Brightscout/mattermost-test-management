---
name: "Emal fallback when AuthData in SAML doesn't match user ID in LDAP"
status: Active
priority: Low
team_ownership: "Suite Users"
---

## MM-T2662: Emal fallback when AuthData in SAML doesn't match user ID in LDAP

---

**Step 1**

Emal fallback when AuthData in SAML doesn't match user ID in LDAP\
————————————————————————————

1. Configure SAML login with LDAP sync where the AuthData value set by SAML is different from the configured LDAP user ID attribute. However, the email field as set by SAML matches the configured LDAP email value.
2. Add user to some groups in LDAP.
3. Link a group.
4. Sync.
5. **Expected**: User is added to the group in Mattermost in spite of the LDAP user ID attribute being different from the AuthData value because it has used the email as a fallback lookup.

\
Perform steps 1-3 above and then instead of syncing perform a first-login procedure.

**Expected**

**Notes from testing with Martin on mysql.test, using QA group sync instance and OneLogin dev instance**:

- User has uid set to mail in LDAP and NOT email in SAML
- LDAP username mail (not actually significant to this test)
- LDAP ID Attribute mail
- SAML username username
- ID Attribute username
- mail in LDAP doesn't match username in SAML

**In general**:

- uid username don't necessarily have to match on both sides
- emails match on both sides = fallback to email
- until this story, group sync wasn't happening for that user
- Now it is!
