---
key: MM-T3139
title: Bad domain name and dpkg-reconfigure
---

## MM-T3139: Bad domain name and dpkg-reconfigure

### Details

| Name     | Value                |
| :------- | :------------------- |
| Priority | Normal               |
| Status   | Active               |
| Folder   | Omnibus              |
| Labels   | Cloud-N/A            |
| Created  | 2020-07-14T18:40:51Z |

### Steps

<hr/>

**Step 1**

> <article>Bad domain name and dpkg-reconfigure<br>————————————————————————————<br>In a new server:<ol><li>Run&nbsp;"curl -o- <a href="https://deb.packages.mattermost.com/repo-setup.sh">https://deb.packages.mattermost.com/repo-setup.sh</a> | sudo bash"</li><li>Run "apt install mattermost-omnibus" and follow the steps. In the domain name prompt, introduce a bad domain name, one that doesn't correspond with the test server</li></ol></article>

**Expected**

> <article><ul><li>The package install should show an error related to the SSL certificate and a help dialog asking the user to run dpkg-reconfigure. The package installation should finish correctly from the Debian perspective</li></ul></article>

<hr/>

**Step 2**

> <article><ol><li>Run "dpkg -l | grep mattermost-omnibus"</li></ol></article>

**Expected**

> <article><ul><li>The mattermost omnibus should be correctly installed (the line should start with "ii")</li></ul></article>

<hr/>

**Step 3**

> <article><ol><li>Go to the server URL</li></ol></article>

**Expected**

> <article><ul><li>The URL should not be accessible</li></ul></article>

<hr/>

**Step 4**

> <article><ol><li>Run "dpkg-reconfigure mattermost-omnibus". Fix the domain name to be the right one</li></ol></article>

**Expected**

> <article><ul><li>The dpkg-reconfigure command should have run mmomni reconfigure command successfully</li></ul></article>

<hr/>

**Step 5**

> <article><ol><li>Go to the server URL</li></ol></article>

**Expected**

> <article><ul><li>The URL should be correctly accessible under the right domain name, with the certificate successfully retrieved and configured</li></ul></article>

<hr/>

### More Info

| Name                     | Value                                         |
| :----------------------- | :-------------------------------------------- |
| Priority P1 to P4        | P2 - Core Functions (Do core functions work?) |
| Rainforest               | N/A                                           |
| Team Ownership           | Server Platform                               |
| Manual Test Environments | CLI                                           |
| Cypress                  | N/A                                           |
| Tags                     | Cloud N/A                                     |
| Location                 | Omnibus                                       |
