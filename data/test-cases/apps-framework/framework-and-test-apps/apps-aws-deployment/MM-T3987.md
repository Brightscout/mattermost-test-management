---
name: "Deploy an App to AWS"
status: Active
priority: Normal
---

## MM-T3987: Deploy an App to AWS

**Objective**

This test will deploy the Service Now app as an AWS Lambda function

**Precondition**

\- Access to AWS\
\- Permissions to upload something to the \`mattermost-apps-bucket-test\` S3 bucket in AWS\
\- Current version of the \`mattermost-plugin-apps\` plugin 

---

**Step 1**

Set environment variables that will link tour local Mattermost server to the AWS instance\
1\. Open a terminal and navigate to your 'mattermost-server' repo\
2\. Stop your server IF it's running\
3\. Type _export MM\_APPS\_S3\_BUCKET=mattermost-apps-assets-bucket-test_\
4\. Type _export APPS\_INVOKE\_AWS\_ACCESS\_KEY=\<test user's access key>_\
5\. Type _export APPS\_INVOKE\_AWS\_SECRET\_KEY==\<test user's secret key>_\
6\. Start your local Mattermost server by typing _make run-server MM\_FEATUREFLAGS\_AppsEnabled=true_

---

**Step 2**

Configure the proxy plugin to register the test app\
1\. Clone down the proxy plugin repo _https\://github.com/mattermost/mattermost-plugin-apps_\
2\. Open _mattermost-plugin-apps/assets/manifests.json_\
3_. _Ads a record for the app you with to deploy ex: _"com.mattermost.servicenow": "0.1.0"_\
4\. Build the proxy plugin

---

**Step 3**

Start an ngrok tunnel that will expose your local Mattermost server to an external DNS

---

**Step 4**

Upload the modified apps plugin\
1\. Navigate to your local and open the plugin settings in the system console\
2\. Upload the plugin build is step 2. - Overwrite the existing version if it's installed\
3\. Ensure the plugin is running

---

**Step 5**

Build the app bundles for Service Now\
1\. Clone down the Service Now repo _https\://github.com/mattermost/mattermost-app-servicenow_\
2_. _Open a terminal and cd into the Service Now directory\
3\. Type _make _to compile the plugin\
4\. Open the _dist _folder and ensure_ bundle.zip _is present

---

**Step 6**

1\. Login to One Login here https\://mattermost.onelogin.com/login\
2\. Select AWS and login asa developer\
3\. Locate and select S3 from the services\
4\. Locate the "mattermost-apps-bucket-test" bucket\
5\. Upload the bundle build in step 5.

---

**Step 7**

Install the bundle\
1\. Navigate to your local via the ngrok tunnel setup in step 3.\
2\. Type _/apps list _and ensure _com.mattermost.servicenow _is listed and the _type _in the _status _colum is showing as _aws\_lambda_\
3\. type _/apps install --app-id  com.mattermost.servicenow_
