---
key: MM-T4044
title: Creating and using subscriptions
---

## MM-T4044: Creating and using subscriptions

**Precondition**

> <article><strong>Requires a sandbox instance of Zendesk with an oAuth 2 application configured.</strong> <br><br>- No Support yet for RN mobile apps</article>

### Details

| Name     | Value                    |
| :------- | :----------------------- |
| Priority | Low                      |
| Status   | Active                   |
| Folder   | Apps Framework / Zendesk |
| Created  | 2021-05-06T15:33:27Z     |

### Steps

<hr/>

**Step 1.2**

> <article>Run <em>/zendesk configure</em> command</article>

**Expected**

> <article>The oAuth modal opens</article>

<hr/>

**Step 1.3**

> <article>1. Add your Zendesk instance URL<br>2. Add the Client ID for your oAuth application<br>3. Add the Client Secret for your oAuth application<br>4. Save</article>

**Expected**

> <article>Ephemeral post from the Zendesk bot confirms the config was updated.</article>

<hr/>

**Step 1.4**

> <article>1. Switch to any other channel you don't have open<br>2.  type&nbsp;<em>/zendesk&nbsp;</em></article>

**Expected**

> <article>The <em>connect&nbsp;</em>command is now available</article>

<hr/>

**Step 2**

> <article>1. Create or locate a test user who has an admin role in Mattermost<br>2. Create or locate a user in Zendesk who has an admin role<br>3. Login to Mattermost as the user from step 1.<br>4. Use the <em>/zendesk connect&nbsp;</em>command to connect to Zendesk as the user from step 2.</article>

**Expected**

> <article>User is connected and the <em>subscribe&nbsp;</em>command is visible as well as the <em>create target</em> command</article>

<hr/>

**Step 3**

> <article>1. Run the <em>/zendesk Setup-Target&nbsp;</em>command<br>2. Open a public channel<br>3. Run the <em>/zendesk subscribe&nbsp;</em>command</article>

**Expected**

> <article>On 1. User see's an ephemeral post from the Zendesk bot that subscriptions target has been created<br>On 3. The subscribe modal opens</article>

<hr/>

**Step 4**

> <article>1. Select the <em>Create New&nbsp;</em>option<br>2. Add a name and do <strong>not&nbsp;</strong>select any fields<br>3. Click Save<br>4. Check the box for all fields <br>5. Save</article>

**Expected**

> <article>on 3. A validation messages informs the user that they must select at least 1 condition<br>on 5. The Modal closes and an ephemeral post from Zendesk bot tells the user the save is in progress</article>

<hr/>

**Step 5**

> <article>1. Wait 60 - 90 seconds (may work faster on Zendesk production instances)<br>2. Open the subscribe modal again in the same channel using either the slash command or channel header</article>

**Expected**

> <article>Ensure the subscription created in step 4. is visible</article>

<hr/>

**Step 6**

> <article>1. Create a ticket in Zendesk that uses a &nbsp;form which includes all the fields (see Tests Data column)<br>2. Leave the channel open and wait 10 - 30 seconds for the subscription event<br><br></article>

**Test Data**

> <article>To test this efficiently create a test form in Zendesk with the following options:<br>- Priority<br>- Type<br>- Group<br>- Assignee</article>

**Expected**

> <article>On 2.<br>The subscription even shows "<strong>[NEW TICKET]</strong> Ticket <a href="https://mattermost1616716488.zendesk.com/agent/tickets/205" rel="noreferrer" target="_blank">#205</a>&nbsp; <strong>Subject: <a href="https://mattermost1616716488.zendesk.com/agent/tickets/205" rel="noreferrer" target="_blank">token subject</a></strong> A new ticket was created with the following properties:"<br><br>Along with as values for the following fields:<br>- Satus<br>- Priority<br>- Type<br>- Group<br>- Assignee<br>- Other fields such as custom fields will also be shown&nbsp;&nbsp;</article>

<hr/>

**Step 7**

> <article>1. Login to Zendesk and view the ticket created above<br>2. Modify <strong>all</strong> the following values<br>3. Then save the changes by selecting a different status such as "Pending"<br>4. open the channel in Mattermost and wait 10 - 30 seconds for the subscription event</article>

**Expected**

> <article>- New and previous values are shown for the following fields<br>-- Status<br>-- Form<br>-- Priority<br>-- Type<br>-- Group<br>-- Assignee<br>- All the values changed are shown in 1 event post</article>

<hr/>

**Step 8**

> <article>null</article>

**Expected**

> <article>An event post with only 1 field is shown<br>"Ticket&nbsp;<a href="https://mattermost1616716488.zendesk.com/agent/tickets/152" rel="noreferrer" target="_blank">#152</a> &nbsp;<strong>Subject: <a href="https://mattermost1616716488.zendesk.com/agent/tickets/152" rel="noreferrer" target="_blank">apples</a></strong> &nbsp;<code>status</code> changed from&nbsp;<code>solved</code> to&nbsp;<code>closed</code>"</article>

**Step Info**
| Name | Value |
| :--- | :--- |
| Related ticket(s) | 1. Login to Zendesk and view the ticket created above<br>2. Modify <strong>only</strong><strong>&nbsp;</strong>the status of the ticket leaving other fields as is<br>3.&nbsp;Leave the channel open and wait 10 - 30 seconds for the subscription event |

<hr/>

**Step 9**

> <article>Repeat step 8. where only one value is changed with the following fields:<br>-- Form<br>-- Priority<br>-- Type<br>-- Group<br>-- Assignee</article>

**Expected**

> <article>The following fields can be changed in isolation and receive an individual subscription event<br>-- Form<br>-- Priority<br>-- Type<br>-- Group<br>-- Assignee</article>

<hr/>

**Step 10**

> <article>1. In Mattermost switch to a private channel and create a subscription as was done above<br>2. Modify Zendesk ticket by changing a value that is targeted by that subscription</article>

**Expected**

> <article>Subscription events can be delivered to private channels&nbsp;</article>

<hr/>

**Step 11**

> <article>1. In Mattermost switch to a GM channel and create a subscription as was done above<br>2. Modify Zendesk ticket by changing a value that is targeted by that subscription</article>

**Test Data**

> <article>**DOES NOT WORK YET**</article>

**Expected**

> <article>Subscription events can be delivered to GM channels&nbsp;</article>

<hr/>

**Step 12**

> <article>1. In Mattermost switch to a DM channel and create a subscription as was done above<br>2. Modify Zendesk ticket by changing a value that is targeted by that subscription</article>

**Test Data**

> <article>**DOES NOT WORK YET**</article>

**Expected**

> <article>Subscription events can be delivered to DM channels&nbsp;</article>

<hr/>

**Step 13**

> <article>1. In Mattermost open a public or private channel and create a subscription as was done above<br>2. Wait for the subscription data to be available in Mattermost (up to 90 seconds)<br>3. Open the subscription modal and select the subscription created above<br>4. Click the delete button<br>5. Wait for the subscription data to be available in Mattermost (up to 90 seconds)<br>6. Open the subscription modal<br>7. In Zendesk on a ticket and modify one of the fields that was targeted by the subscription</article>

**Expected**

> <article>On 4. The modal closes<br>On 6. The subscription is no longer visible<br>on 7. No subscription event occurs for a deleted subscription</article>

<hr/>

### More Info

| Name                     | Value          |
| :----------------------- | :------------- |
| Manual Test Environments | Webapp,Desktop |
| Tags                     | Never tested   |
| Location                 | Integrations   |
